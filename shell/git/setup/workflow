#!/usr/bin/env bash

set -e

mkdir -p "$HOME/GitHub/NikoboiNFTB"
cd "$HOME/GitHub/NikoboiNFTB"

# Fetch repo list
echo "Fetching repo list for NikoboiNFTB..."
repos=$(curl -s "https://api.github.com/users/NikoboiNFTB/repos?per_page=100" | jq -r '.[].name')

if [ -z "$repos" ]; then
    echo "No repositories found."
    exit 1
fi

# Clone or update repos
echo "Processing repositories..."
for repo in $repos; do
    if [ -d "$repo/.git" ]; then
        echo "$repo already exists, pulling updates..."
        git -C "$repo" pull --quiet || echo "Failed to pull $repo" >&2
    else
        echo "Cloning $repo..."
        if git clone "git@github.com:NikoboiNFTB/$repo.git" >/dev/null 2>&1; then
            echo "Cloned $repo"
        else
            echo "Failed to clone $repo" >&2
        fi
    fi
done
